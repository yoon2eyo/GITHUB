@startuml AuthenticationServiceComponent
' AuthService_component.puml (가이드 준수)

package "Interface Layer" {
  interface IAuthServiceApi
  interface IAuthManagementApi
  
  component AuthServiceController
  component UserManagementController
  
  ' API implementations
  IAuthServiceApi -- AuthServiceController
  IAuthManagementApi -- UserManagementController
}

package "Business Layer" {
  interface IAuthenticationService
  interface IAuthorizationService
  interface IUserRegistrationService
  
  component AuthenticationManager
  component AuthorizationManager
  component UserRegistrationManager
  component AuthEventConsumer
  
  ' Service implementations
  IAuthenticationService -- AuthenticationManager
  IAuthorizationService -- AuthorizationManager
  IUserRegistrationService -- UserRegistrationManager
  
  ' Business layer internal relationships
  AuthenticationManager ..( IAuthorizationService : <<Local>>
  UserRegistrationManager ..( IAuthenticationService : <<Local>>
}

package "System Interface Layer" {
  interface IAuthRepository
  interface IMessagePublisherService
  interface IMessageSubscriptionService
  interface ITokenService
  interface ICreditCardVerificationService
  
  component AuthJpaRepository
  component RabbitMQAdapter
  component JwtTokenManager
  component CreditCardVerificationClient
  database AuthDatabase
  
  ' System interface implementations
  IAuthRepository -- AuthJpaRepository
  IMessagePublisherService -- RabbitMQAdapter
  IMessageSubscriptionService -- RabbitMQAdapter
  ITokenService -- JwtTokenManager
  ICreditCardVerificationService -- CreditCardVerificationClient
  
  ' System dependencies
  AuthJpaRepository ..( AuthDatabase : <<JDBC>>
}

' 패키지 외부 연결
' Interface Layer -> Business Layer
AuthServiceController ..( IAuthenticationService : <<HTTP>>
AuthServiceController ..( IAuthorizationService : <<HTTP>>
UserManagementController ..( IUserRegistrationService : <<HTTP>>

' Business Layer -> Message Broker 연결
AuthenticationManager ..( IMessagePublisherService : <<RabbitMQ>>
AuthorizationManager ..( IMessagePublisherService : <<RabbitMQ>>
UserRegistrationManager ..( IMessagePublisherService : <<RabbitMQ>>
AuthEventConsumer ..( IMessageSubscriptionService : <<RabbitMQ>>

' Business Layer -> System Interface Layer
AuthenticationManager ..( IAuthRepository : <<JDBC>>
AuthenticationManager ..( ITokenService : <<Local>>
AuthenticationManager ..( ICreditCardVerificationService : <<HTTP>>
AuthorizationManager ..( IAuthRepository : <<JDBC>>
UserRegistrationManager ..( IAuthRepository : <<JDBC>>
AuthEventConsumer ..( IAuthRepository : <<persist>>

legend right
  Auth Service structure
  - Authentication and authorization services
  - User registration and management
  - Token-based security with JWT
  - Event-driven updates for auth state changes
end legend

@enduml
