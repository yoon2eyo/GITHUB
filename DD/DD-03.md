네, 다음 디자인 결정인 **DD-03 (저장소 관리 구조)**에 대한 최종 선택안 상세 정보를 출력하겠습니다.

이 결정은 **하이브리드 MSA 구조**의 핵심인 **데이터 캡슐화**와 **수정 용이성**을 확보하는 데 중점을 둡니다.

---

## 🛠️ DD-03 저장소 관리 구조 최종 선택안

| 결정 ID | 디자인 결정 주제 | 최종 선택안 |
| :--- | :--- | :--- |
| **DD-03** | 저장소 관리 구조 | **Database per Service (서비스당 DB) 원칙 준수** |

### 🎯 채택 상세 정보

저희 시스템은 **수정 용이성(Modifiability)**과 **데이터 캡슐화**를 최우선 목표로 삼아, 모든 마이크로서비스가 자신의 독립된 데이터베이스를 소유하는 **Database per Service** 원칙을 채택했습니다.

#### 1. 구조적 원칙 및 패턴

* **Database per Service:** 모든 핵심 서비스 (Auth, Helper, Search, Monitor)는 각각 **자신만의 독립적인 DB 인스턴스**를 소유하고 관리합니다 (예: DB\_AUTH, DB\_HELPER 등).
* **캡슐화 (Encapsulate):** 각 서비스는 자신의 데이터 구조에 대한 **소유권**을 가지며, 다른 서비스의 DB에 직접 접근하는 것은 엄격히 금지됩니다. 이로써 서비스 간의 **결합도를 감소**시킵니다.
* **Repository Pattern:** 각 서비스는 자신의 DB에 접근하기 위해 **`I*Repository` 인터페이스(계약)**를 정의합니다. 실제 DB 연결 로직(DAL 구현체)은 이 인터페이스 계약 뒤에 숨겨집니다.

#### 2. 데이터 접근 및 통신 전략

| 접근 유형 | 설명 | 관련 MSA 원칙 |
| :--- | :--- | :--- |
| **일반 접근** | **Helper Service**가 **DB\_HELPER**에 접근하듯이, 각 서비스는 자신이 소유한 DB에만 **직접 연결(내부 DAL 구현)**합니다. | **수정 용이성**, **응집도 증가** |
| **교차 도메인 접근 (Read)** | **MLOPS/Training Service**는 학습 데이터를 수집하기 위해 **Auth DB**나 **Helper DB**에 **읽기 전용 계정**으로 접속하는 예외적 경로를 허용합니다. | **MSA Trade-off (효율성)**: 대량 데이터 수집 성능 확보를 위한 실용적인 예외. |
| **통합 조회** | **Search Service**가 고객 리뷰와 지점 정보를 통합 조회할 때는, **Data Replication (비동기 복제)** 전략이나 **API Composition** 대신, **전문 검색 엔진(DS-07)**을 활용하여 **로컬에서 고속 조회**를 수행하는 방식을 채택합니다. | **Performance**, **Data Replication** (간접적) |
| **고성능 분리** | **Access Service**는 **DB\_VECTOR (안면 벡터 DB)**라는 특수 DB를 사용하며, 이는 다른 비즈니스 데이터와 물리적으로 분리되어 **초저지연 성능**을 보장합니다. | **Separate Entities** |

#### 3. 인터페이스의 역할 (DD-03의 핵심)

모든 데이터 접근 계약(IAuthRepository, IHelperRepository 등)은 **Persistence Layer**가 아닌 **Application Layer의 각 소유 서비스 내부**에 정의되어, **느슨한 결합**을 보장합니다.

---

Would you like to proceed with the next design decision, **DD-04 (고장 감지 및 실시간 알림)**?