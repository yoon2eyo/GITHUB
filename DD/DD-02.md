네, 다음 디자인 결정인 **DD-02 (노드 간 통신 방식)**에 대한 최종 선택안 상세 정보를 출력하겠습니다.

이 결정은 **하이브리드 MSA 구조** 내에서 서비스 간의 **느슨한 결합**과 **고가용성**을 확보하는 데 중점을 둡니다.

---

## 🛠️ DD-02 노드 간 통신 방식 최종 선택안

| 결정 ID | 디자인 결정 주제 | 최종 선택안 |
| :--- | :--- | :--- |
| **DD-02** | 노드 간 통신 방식 | **하이브리드 통신 (동기식 + Message Broker 기반 비동기)** |

### 🎯 채택 상세 정보

저희 시스템은 **실시간 성능(Performance)**과 **운영 자동화(Availability)**를 모두 요구하므로, 상황에 따라 **동기식(Synchronous)**과 **비동기식(Asynchronous)** 통신을 혼합하는 전략을 채택했습니다.

#### 1. 동기식 통신 (Synchronous: HTTPS/gRPC)

* **목적:** **즉각적인 응답**과 **초저지연 성능**이 필수적인 기능에 사용됩니다.
* **패턴:** **Client-Server** 및 **Microservice** (REST/gRPC).
* **주요 적용 영역:**
    * **출입 인증 (DD-05):** **Access Service** $\leftrightarrow$ **FACE MODEL Service** 간의 초저지연 벡터 비교 연산은 **IPC/gRPC**를 사용하여 Latency를 최소화합니다.
    * **API Gateway 라우팅:** **클라이언트 앱** $\leftrightarrow$ **API Gateway** $\leftrightarrow$ **Auth Service** (로그인), **Search Service** (검색)와 같은 요청은 **HTTPS/REST**를 기본으로 사용합니다.

#### 2. 비동기식 통신 (Asynchronous: Message Broker)

* **목적:** **느슨한 결합**과 **작업 처리 안정성**이 필수적인 기능에 사용됩니다.
* **패턴:** **Message Based** (메시지 기반) 및 **Event Based** (이벤트 기반).
* **핵심 택틱:** **Use an Intermediary (중개자 사용)** 및 **Passive Redundancy (수동적 중복)**.
* **주요 적용 영역:**
    * **운영 자동화 (DD-04):** **Monitoring Service**가 고장 이벤트를 발행하면, **NotificationDispatcher**가 비동기적으로 구독하여 알림을 보냅니다 (시스템 안정성 확보).
    * **작업 및 보상:** **Helper Service**가 **작업 등록 이벤트**를 발행하면, **AIPanDokuConsumer**가 비동기적으로 판독을 수행합니다 (Helper Service의 응답 시간 보호).
    * **맞춤형 알림 (DD-07):** **Search Service**가 **성향 생성 이벤트**를 발행하면, **Scheduling Policy**에 따라 **PreferenceMatchConsumer**가 지연 처리하여 성능 부하를 분산시킵니다.

#### 3. Message Broker의 역할

**Message Broker (MB)**는 **Persistence Layer**에 위치하며, **Application Layer** 서비스 간의 모든 비동기 이벤트 전달을 담당하는 중앙 허브입니다. 이는 **DD-07**과 **DD-04**의 비동기 워크플로우 안정성에 결정적인 역할을 합니다.

---

Would you like to proceed with the next design decision, **DD-03 (저장소 관리 구조)**?