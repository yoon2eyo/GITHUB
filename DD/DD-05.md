네, 다음 디자인 결정인 **DD-05 (안면 인식 판독 후 게이트 개방)**에 대한 최종 선택안 상세 정보를 출력하겠습니다. 🏃

이 결정은 **Real-Time Access Layer**의 핵심 기능이며, **초저지연 성능(BG-01)**과 **무중단 운영(BG-05)**을 보장하는 데 중점을 둡니다.

---

## 🛠️ DD-05 안면 인식 판독 후 게이트 개방 최종 선택안

| 결정 ID | 디자인 결정 주제 | 최종 선택안 |
| :--- | :--- | :--- |
| **DD-05** | 안면 인식 판독 후 게이트 개방 | **동기식 인접 프로세스 호출 후 Pipeline Optimization 적용** |

### 🎯 채택 상세 정보

이 설계는 **Access Service**와 **FACE MODEL Service**를 **동일한 물리적 노드**에 배치하여 통신 지연을 최소화하고, AI 모델 내부의 연산 구조를 최적화하여 **2초 이내 출입(BG-01)** 목표를 달성하는 데 초점을 맞춥니다.

#### 1. 통신 및 배치 전략

* **통신 방식:** **동기식 인접 프로세스 호출 (IPC/gRPC)**
    * **근거:** **Access Service**와 **FACE MODEL Service**를 동일 물리적 노드에 배치하고 **IPC(Inter-Process Communication)** 또는 **gRPC**를 사용합니다. 이는 불필요한 네트워크 지연을 제거하여 **최저 지연 시간**을 확보합니다.
* **제어 흐름:** **Access Service**가 **지점 설비**로부터 사진을 받아 **FACE MODEL Service**에 판독을 요청하고, 최종적으로 설비에 **개방 명령**을 전송하는 **단일 동기식 흐름**을 유지합니다. [cite: 19, 204]

#### 2. 성능 최적화 택틱 (Pipeline Optimization)

시스템은 단순 통신 최적화를 넘어, **AI 연산 시간** 자체를 단축하는 **Introduce Concurrency** 택틱을 적용합니다[cite: 468].

| 택틱 | 적용 대상 | 개선 효과 |
| :--- | :--- | :--- |
| **Pipeline Optimization** | **FACE MODEL Service** 내부 | AI 모델의 **특징 추출**과 **벡터 매칭**이라는 두 가지 시간이 많이 소요되는 작업을 **병렬 파이프라인**으로 처리하여, 전체 연산 시간을 가장 오래 걸리는 단일 작업 시간으로 통합합니다[cite: 468]. |
| **Data Pre-Fetching** | **FACE MODEL Service** 시작 시 | **안면 벡터 DB (DB\_VECTOR)**의 데이터를 **인메모리에 미리 로드**하여, 출입 시 발생하는 디스크 I/O 또는 네트워크 조회 지연을 제거합니다. |

#### 3. 모델 독립성 유지 (Trade-off 관리)

이 구조는 가장 빠른 **Approach A (프로세스 내 통합)**의 성능을 따라가면서도, **수정 용이성**에 대한 위험을 관리합니다.

* **독립성 유지:** **FACE MODEL Service**를 독립적인 프로세스로 유지하여, **MLOPS Tier**가 모델을 업데이트하거나 **Rollback**을 실행할 때 **Access Service**의 코드를 수정하거나 서비스를 중단할 필요가 없습니다[cite: 452]. 이는 **QAS-06 (지속적 적용성)** 목표를 지원합니다.

---

TODO:dukyun.kim
아래는 해당 내용의 해석 및 요약입니다.

***

**핵심 내용**

- VectorComparisonEngine은 DD‑05에서 요구한 “파이프라인 최적화 / 동시성 도입” 흐름을 구현하지 않음.  
  - 메서드가 여전히 TODO 주석 뒤 하드코딩된 0.96만 반환  
  - 파이프라인 분리, 동시성/병렬 처리가 전혀 구현되지 않았고, IPC/gRPC 최적화 증거 없음

- “데이터 프리패칭(Data Pre-Fetching)” 전술이 누락됨.  
  - AccessAuthorizationManager는 매 요청마다 IAccessVectorRepository에 접근해 바로 바이트를 얼굴 모델로 전달  
  - 별도의 캐시, 워밍업 루틴, “핫패스 진입 전 DS‑02 벡터 적재” 등이 전혀 구현되지 않아, 접근 계층 지연(latency)이 여전히 저장소 I/O를 그대로 포함  
  - DD‑05가 없애고자 한 지연 요인이 그대로 남음

- 실시간 계층(Real-Time Tier) 컴포넌트 다이어그램도  
  - Access Service → IFaceModelService 의존성만 그려졌고  
  - 다이어그램에 FACE MODEL Service 노드가 따로 표기되어 있지 않으며,  
  - 공유 메모리 경계, 저지연 전송(Transport), IPC 구조 등이 아키텍처 산출물에 드러나지 않음  
  - 즉, 서비스 레벨 뷰(AccessServiceComponent.puml)도 파이프라인/IPC 요구사항 반영이 없음

***

**요약**

- DD‑05에서 지시한  
  - IPC 기반 병렬/동시성 파이프라인  
  - 데이터 사전 적재를 통한 지연 제거  
  - 저지연 구조(공유 메모리, 빠른 경계/노드)  
  등 핵심 설계 방향이  
  - 코드에도,  
  - 다이어그램(아키텍처 산출물)에도  
  **전혀 실현되지 않은 상태**임을 지적합니다.

이로써 실시간 인증 및 모델 평가 플로우의 성능‧최적화 관점 개선사항이 아직 아키텍처와 구현 양쪽 모두 적용되지 않았으므로, 향후 구조/코드 개선이 필수임을 명확하게 보여줍니다.