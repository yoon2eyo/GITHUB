네, 다음 디자인 결정인 **DD-07 (고객 맞춤형 알림 부하 분산)**에 대한 최종 선택안 상세 정보를 출력하겠습니다. 📢

이 결정은 **UC-11 (맞춤형 알림 발송)**을 **시스템 성능(QAS-03)**에 영향을 주지 않으면서 처리하기 위한 **Trade-off** 전략입니다.

---

## 🛠️ DD-07 맞춤형 알림 부하 분산 구조 최종 선택안

| 결정 ID | 디자인 결정 주제 | 최종 선택안 |
| :--- | :--- | :--- |
| **DD-07** | 맞춤형 알림 부하 분산 | **Approach C: 매칭 지연 및 부하 분산 (Scheduling Policy 적용)** |

### 🎯 채택 상세 정보

이 설계는 **UC 요구사항(이벤트 기반)**을 준수하면서도, **Search Service**의 **실시간 검색 성능**을 보호하기 위해 **알림 매칭 작업**의 실행을 **비피크 시간**으로 지연시키는 전략을 채택했습니다.

#### 1. 이벤트 트리거 및 처리 방식

* **트리거 시점:** **지점 정보/리뷰 등록** 시 **`BranchPreferenceCreatedEvent`**가 **Message Broker (MB)**에 즉시 발행됩니다.
* **패턴:** **Message Based** / **Event Based**.
* **컴포넌트:** **Search Service**에 속한 **`PreferenceMatchConsumer`**가 이 이벤트를 구독합니다.

#### 2. 부하 분산 및 성능 보호 택틱

이 접근 방식의 핵심은 **실시간 검색(High Priority)** 기능을 **알림 매칭(Low Priority)** 작업으로부터 격리하는 것입니다.

| 택틱 | 적용 대상 | 설명 및 목표 |
| :--- | :--- | :--- |
| **Scheduling Policy** | **PreferenceMatchConsumer** | 이벤트 수신 시 **피크 타임 (예: 18시~20시)**을 감지하면, 매칭 작업을 즉시 실행하지 않고 **비피크 시간까지 처리 대기**하도록 스케줄링합니다. |
| **Degradation 방지** | **Search Service** | **Low Priority** 작업을 지연 처리함으로써, 피크 타임에 대량의 매칭 쿼리가 **실시간 자연어 검색(QAS-03)**의 응답 속도에 영향을 주는 것을 방지합니다. |
| **가용성 확보** | **Message Broker** | **Passive Redundancy**를 통해 이벤트가 큐에 안전하게 보존되므로, 처리 대기 중 시스템 장애가 발생하더라도 **알림 데이터 손실 없이** 복구 후 처리가 가능합니다. |

#### 3. Trade-off (실시간성 양보)

* **실시간성:** 알림이 **지점 성향 생성 시점**과 **동일 시간**에 발송되지 않고 **최대 몇 시간 지연**됩니다.
* **BG-03 효과:** 알림의 **즉각성**은 희생되지만, **시스템의 안정성**과 **주요 기능(검색)의 성능**을 확보하는 것이 더 중요한 운영상의 결정입니다.

---

Would you like to proceed with the next design decision, **DD-08 (AI 모델 학습 및 배포)**?