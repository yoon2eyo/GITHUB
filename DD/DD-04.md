네, 다음 디자인 결정인 **DD-04 (고장 감지 및 실시간 알림)**에 대한 최종 선택안 상세 정보를 출력하겠습니다. 🔔

이 결정은 **24시간 무인 운영(BG-05)**의 핵심인 **시설 고장 감지**와 **신속한 알림(BG-06)**을 보장하는 **가용성(Availability)** 목표에 중점을 둡니다.

---

## 🛠️ DD-04 고장 감지 및 실시간 알림 체계 최종 선택안

| 결정 ID | 디자인 결정 주제 | 최종 선택안 |
| :--- | :--- | :--- |
| **DD-04** | 고장 감지 및 알림 | **Approach A: Polling & Message Bus (Ping/echo 기반 비동기 알림)** |

### 🎯 채택 상세 정보

이 설계는 설비 상태 모니터링을 **Process Control** 스타일로 구현하며, **Heartbeat** 감지 실패 시 **Ping/echo**를 통해 고장을 확증하고 **Message Broker**로 알림을 전송하여 신뢰성을 확보합니다.

#### 1. 고장 감지 메커니즘 및 택틱

저희 시스템은 **두 가지 경로**를 통해 설비의 고장 상태를 감지합니다[cite: 328, 333].

| 경로 | 택틱 | 설명 |
| :--- | :--- | :--- |
| **설비 주도 보고** | **Heartbeat (하트비트)** | **지점 설비**가 주기적으로(예: 10분 간격) **Monitoring Service**에 자신의 상태를 보고합니다[cite: 331, 138, 448]. 설비가 명시적으로 '고장'을 보고하면 즉시 알림이 트리거됩니다[cite: 329]. |
| **시스템 주도 모니터링** | **Ping/echo** | **Monitoring Service**가 **타이머**에 의해 트리거되어 (예: 10초 간격), 설비의 **최근 보고 기록이 30초 이내**인지 점검합니다[cite: 335, 336]. 누락이 감지되면 시스템이 설비에 **상태 보고 요청(Ping)**을 보내 응답을 확인합니다[cite: 447, 140]. |
| **복구 지원** | **Maintain Audit Trail** | 고장 및 알림 발송 기록을 유지하여 **지점 설비 업체**의 **정확한 설비 고장 정보 획득(BG-07)** 및 유지보수 효율을 증대합니다[cite: 474]. |

#### 2. 실시간 알림 및 통신 전략

* **통신 패턴:** **Message Based (메시지 기반)**
* **컴포넌트:** **Monitoring Service**가 고장 이벤트 발행, **NotificationDispatcher**가 구독.
* **핵심 택틱:** **Passive Redundancy** 및 **Use an Intermediary**.
    * 고장이 확증되면 **Monitoring Service**가 **Message Broker (MB)**에 이벤트를 발행합니다.
    * MB는 이 이벤트를 **NotificationDispatcher**로 전달하며, 전달 과정에서 네트워크 장애가 발생하더라도 큐에 메시지를 보존하여 **알림 누락**을 방지합니다.
    * 최종적으로 **NotificationDispatcher**가 **관리자 앱**으로 **푸시 알림**을 발송합니다 (목표: 고장 감지 시 **1분 이내 알림 발송 [cite: 62]**).

이 구조는 **고장 감지 시 15초 이내 알림 발송(QAS-01)** 목표를 달성하는 데 최적화되어 있습니다[cite: 364].

---

Would you like to proceed with the next design decision, **DD-05 (안면 인식 판독 후 게이트 개방)**?